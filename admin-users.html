<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원 관리 - 이온토플 관리자</title>
    
    <!-- Pretendard Font -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <!-- Admin Navigation -->
    <nav class="admin-nav">
        <div class="container">
            <div class="admin-nav-brand">
                <i class="fas fa-shield-alt"></i>
                <span>이온토플 관리자</span>
            </div>
            <div class="admin-nav-menu">
                <a href="admin-dashboard.html" class="admin-nav-link">
                    <i class="fas fa-home"></i> 대시보드
                </a>
                <a href="admin-applications.html" class="admin-nav-link">
                    <i class="fas fa-clipboard-list"></i> 신청서 관리
                </a>
                <a href="admin-users.html" class="admin-nav-link active">
                    <i class="fas fa-users"></i> 회원 관리
                </a>
                <a href="admin-settings.html" class="admin-nav-link">
                    <i class="fas fa-cog"></i> 사이트 설정
                </a>
                <a href="index.html" class="admin-nav-link">
                    <i class="fas fa-globe"></i> 사이트로
                </a>
                <div class="admin-nav-user" id="adminUser">
                    <i class="fas fa-user-circle"></i>
                    <span id="adminName">관리자</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="admin-container">
        <!-- Header -->
        <div class="admin-header">
            <h1 class="admin-title">👥 회원 관리</h1>
            <p class="admin-subtitle">회원 정보를 조회하고 관리하세요</p>
        </div>

        <!-- Search & Filter -->
        <div class="admin-card" style="margin-bottom: 24px;">
            <div style="display: flex; gap: 16px; align-items: center; flex-wrap: wrap;">
                <input type="text" id="searchInput" placeholder="🔍 이름, 이메일, 전화번호 검색..." 
                       style="flex: 1; min-width: 200px; padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px;">
                
                <select id="levelFilter" style="padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px;">
                    <option value="">전체 등급</option>
                    <option value="2">등급 2 (학생)</option>
                    <option value="5">등급 5 (선생님)</option>
                    <option value="10">등급 10 (관리자)</option>
                </select>
                
                <select id="statusFilter" style="padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px;">
                    <option value="">전체 상태</option>
                    <option value="active">정상</option>
                    <option value="blocked">차단</option>
                </select>
                
                <button onclick="searchUsers()" class="admin-btn admin-btn-primary">
                    <i class="fas fa-search"></i> 검색
                </button>
            </div>
        </div>

        <!-- Stats Cards -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 32px;">
            <div class="admin-card" style="text-align: center;">
                <div style="font-size: 14px; color: #64748b; margin-bottom: 8px;">전체 회원</div>
                <div style="font-size: 32px; font-weight: 700; color: #9480c5;" id="totalUsers">-</div>
            </div>
            <div class="admin-card" style="text-align: center;">
                <div style="font-size: 14px; color: #64748b; margin-bottom: 8px;">등급 2 (학생)</div>
                <div style="font-size: 32px; font-weight: 700; color: #3b82f6;" id="level2Count">-</div>
            </div>
            <div class="admin-card" style="text-align: center;">
                <div style="font-size: 14px; color: #64748b; margin-bottom: 8px;">등급 5 (선생님)</div>
                <div style="font-size: 32px; font-weight: 700; color: #10b981;" id="level5Count">-</div>
            </div>
            <div class="admin-card" style="text-align: center;">
                <div style="font-size: 14px; color: #64748b; margin-bottom: 8px;">등급 10 (관리자)</div>
                <div style="font-size: 32px; font-weight: 700; color: #f59e0b;" id="level10Count">-</div>
            </div>
        </div>

        <!-- Users Table -->
        <div class="admin-card">
            <div class="admin-card-title">
                <i class="fas fa-users"></i> 회원 목록
            </div>
            
            <div style="overflow-x: auto;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th style="width: 80px;">번호</th>
                            <th>이름</th>
                            <th>이메일</th>
                            <th>전화번호</th>
                            <th style="width: 100px;">등급</th>
                            <th style="width: 100px;">상태</th>
                            <th style="width: 150px;">가입일시</th>
                            <th style="width: 200px;">액션</th>
                        </tr>
                    </thead>
                    <tbody id="usersBody">
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 60px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: #9480c5;"></i>
                                <p style="margin-top: 16px; color: #64748b;">회원 목록을 불러오는 중...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 비밀번호 초기화 모달 -->
    <div id="resetPasswordModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: white; padding: 32px; border-radius: 16px; max-width: 500px; width: 90%;">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 16px;">🔐 비밀번호 초기화</h2>
            <p style="color: #64748b; margin-bottom: 24px;">
                <strong id="resetUserName"></strong> 님의 비밀번호를<br>
                <strong style="color: #9480c5;">000000</strong>으로 초기화하시겠습니까?
            </p>
            <div style="display: flex; gap: 12px;">
                <button onclick="closeResetPasswordModal()" class="admin-btn" style="flex: 1;">
                    취소
                </button>
                <button onclick="confirmResetPassword()" class="admin-btn admin-btn-primary" style="flex: 1;">
                    초기화
                </button>
            </div>
        </div>
    </div>

    <script src="js/supabase-config.js"></script>
    <script src="js/common.js"></script>
    <script src="js/admin-utils.js"></script>
    <script src="js/main.js"></script>
    <script src="js/admin-users.js"></script>
</body>
</html>
